/*! messagingio - v0.0.4 - 2013-10-17
* Copyright (c) 2013 ; Licensed  */
function MessagingIO(e){var t=this,n={target:undefined,sendReciept:!0};e===undefined&&(e={}),t.options=e,t.utils.extend(n,t.options),t.target=e.target,t.ready=!1,t.sendQueue=[],t.receiveQueue=[];if(t.target===undefined)t.target=window;else{if(window===t)return new MessagingIO(e);t.targetSource=t.target,t.targetElement=document.createElement("iframe"),t.targetElement.setAttribute("src",t.targetSource),t.targetElement.style.display="none",document.body.appendChild(t.targetElement),t.target=t.targetElement.contentWindow}return t.messageReceiver=function(e){if(t.target.location.origin===e.origin){t.receiveQueue.push(e.data);var n=new CustomEvent("addedToInQueue",{message:e.data,time:new Date,bubbles:!0,cancelable:!1});window.dispatchEvent(n)}},t.callback=function(e){console.log(e)},t.flushQueues=function(){if(t.ready){var e;while(t.sendQueue.length>0)e=t.sendQueue.pop(),t.target.postMessage(e,t.target.location.origin);while(t.receiveQueue.length>0)e=t.receiveQueue.pop(),t.callback(e)}},t.setReady=function(){t.ready=!0,t.flushQueues()},window.addEventListener("addedToOutQueue",t.flushQueues,!1),window.addEventListener("addedToInQueue",t.flushQueues,!1),t}MessagingIO.prototype={about:{Version:"0.0.4",Author:"Britt Gresham",Created:"Fall 2013",Updated:"October 11th, 2013"},utils:{extend:function(e,t){var n=Object.keys(e);for(var r in n)n[r]in t||(t[n[r]]=e[n[r]])}},start:function(){return window.addEventListener?window.addEventListener("message",this.messageReceiver,!1):window.attachEvent&&window.attachEvent("message",this.messageReceiver),this.target.addEventListener("load",this.setReady,!1),this},stop:function(){return window.removeEventListener?window.removeEventListener("message",this.messageReceiver,!1):window.removeEvent&&window.removeEvent("message",this.messageReceiver),this},sendMessage:function(e){this.sendQueue.push(e);var t=new CustomEvent("addedToOutQueue",{message:e,time:new Date,bubbles:!0,cancelable:!1});return window.dispatchEvent(t),this}};